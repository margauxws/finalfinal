<!DOCTYPE html>
<html>
<head>
  <title>Manhattan Weather</title>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDN-1heGoq8NOn-qAheZ8Dkx9gw4P02ty0&signed_in=true&callback=initMap"
    async defer></script>
    <script>
    $(document).ready(function(){

$("#output").html("What does Manhattan feel like today?");

      var dateTime = new Date();
      var currentEpoch = dateTime.getTime();
      var markers = new Array();
      var Manhattan = {lat: 40.674, lng: -73.9924077};

      var api = {};

      api.key = "";
        api.state = "NY";
        api.city = "Manhattan";

        api.conditions = "http://cooper-union-weather-proxy.herokuapp.com/weather/"+api.state+"/"+api.city;
        $.ajax({
              type: 'GET',
              dataType: 'json',
              url: api.conditions,
              success: function(response){
                    $("#location").html(api.city + ", " + api.state);


                var tempfeelslike = response.current_observation.feelslike_f;

                if(tempfeelslike >= 70 && tempfeelslike < 90){
                  function initMap() {
                        var customMapType = new google.maps.StyledMapType([
                            {
                              stylers: [
                                {hue: '#9C2A3F'},
                                {visibility: 'simplified'},
                                {gamma: 0.5},
                                {weight: 0.5}
                              ]
                            },
                            {
                              elementType: 'labels',
                              stylers: [{visibility: 'off'}]
                            },
                            {
                              featureType: 'water',
                              stylers: [{color: '#9C2A3F'}]
                            }
                          ], {
                            name: 'Custom Style'
                        });
                        var customMapTypeId = 'custom_style';

                        var map = new google.maps.Map(document.getElementById('map'), {
                          zoom: 12,
                          center: {lat: 40.674, lng: -73.946},  // Brooklyn.
                          mapTypeControlOptions: {
                            mapTypeIds: [google.maps.MapTypeId.ROADMAP, customMapTypeId]
                          }
                        });

                        map.mapTypes.set(customMapTypeId, customMapType);
                        map.setMapTypeId(customMapTypeId);
        
                      }
                        initMap();
                        $('#weather').html("Currently, it feels like " + tempfeelslike + " degrees Fahrenheit.");
                    $.getJSON("http://cooper-union-instagram-proxy.herokuapp.com/search/tag/tropical", function(response){
                      console.log(response);
                      for(var i=0; i<response.length; i++) {
                        $("#hiddenheader").append("<img src="+response[i].images.thumbnail.url+" />");
                      }
                    });

                }

                else if (tempfeelslike >= 55 && tempfeelslike <70){
                    function initMap() {
                        var customMapType = new google.maps.StyledMapType([
                            {
                              stylers: [
                                {hue: '#DEA112'},
                                {visibility: 'simplified'},
                                {gamma: 0.5},
                                {weight: 0.5}
                              ]
                            },
                            {
                              elementType: 'labels',
                              stylers: [{visibility: 'off'}]
                            },
                            {
                              featureType: 'water',
                              stylers: [{color: '#DEA112'}]
                            }
                          ], {
                            name: 'Custom Style'
                        });
                        var customMapTypeId = 'custom_style';

                        var map = new google.maps.Map(document.getElementById('map'), {
                          zoom: 12,
                          center: {lat: 40.674, lng: -73.946}, 
                          mapTypeControlOptions: {
                            mapTypeIds: [google.maps.MapTypeId.ROADMAP, customMapTypeId]
                          }
                        });

                        map.mapTypes.set(customMapTypeId, customMapType);
                        map.setMapTypeId(customMapTypeId);
        
                      }
                        initMap();
                        $('#weather').html("Currently, it feels like " + tempfeelslike + " degrees Fahrenheit.");
                    $.getJSON("http://cooper-union-instagram-proxy.herokuapp.com/search/tag/warm", function(response){
                      console.log(response);
                      for(var i=0; i<response.length; i++) {
                        $("#hiddenheader").append("<img src="+response[i].images.thumbnail.url+" />");
                      }
                    });

                }


                else if (tempfeelslike >= 30 && tempfeelslike <55){
                      function initMap() {
                        var customMapType = new google.maps.StyledMapType([
                            {
                              stylers: [
                                {hue: '#276073'},
                                {visibility: 'simplified'},
                                {gamma: 0.5},
                                {weight: 0.5}
                              ]
                            },
                            {
                              elementType: 'labels',
                              stylers: [{visibility: 'off'}]
                            },
                            {
                              featureType: 'water',
                              stylers: [{color: '#276073'}]
                            }
                          ], {
                            name: 'Custom Style'
                        });
                        var customMapTypeId = 'custom_style';

                        var map = new google.maps.Map(document.getElementById('map'), {
                          zoom: 12,
                          center: {lat: 40.7564396, lng: -73.9924077},  
                          mapTypeControlOptions: {
                            mapTypeIds: [google.maps.MapTypeId.ROADMAP, customMapTypeId]
                          }
                        });

                        map.mapTypes.set(customMapTypeId, customMapType);
                        map.setMapTypeId(customMapTypeId);
        
                      }
                        initMap();
                    $('#weather').html("Currently, it feels like " + tempfeelslike + " degrees Fahrenheit.");
                    $.getJSON("http://cooper-union-instagram-proxy.herokuapp.com/search/tag/cold", function(response){
                      console.log(response);
                      for(var i=0; i<response.length; i++) {
                        $("#hiddenheader").append("<img src="+response[i].images.thumbnail.url+" />");
                      }
                    });
                }

                else {
                    $('#weather').html("ERROR");
                }

          var rain = response.current_observation.precip_today_in;
                if(rain >= 2 && rain < 4) {
                  console.log('a ton of rain');
                  $("#precipitation").html("I apologize deeply. It appears that you are in the middle of a downpour.");

                }
                else if (rain > 0 && rain < 2){
                console.log('slight rain');
                $("#precipitation").html("Unfortunately, it is raining today.");
            
                }
                else if (rain == 0){
                console.log('there is no rain');
                $("#precipitation").html("Luckily, it is not raining today.");
            
                  }

                


              //do not delete these-for some reason code does not operate correctly without them  
              }



            });
 

          });
    </script>
    <style>

    body{
      background-color:white;
      font-family: Futura, sans-serif;
    }
    h1 {
      color: #77828C;
      font-size: 1.4rem;
      text-transform: uppercase;
      font-family: Arial, Georgia, 'Droid Sans', sans-serif;
      letter-spacing: 3px;
      font-weight: bold;
      line-height: 1;
    }

    #header {
      padding-top: 20px;
      width: 100%;
      height: 30%;
      z-index: 1;
      position: absolute;
      top: 0px;
      background-color: white;
      opacity: 0.8;
    }
    #output {
      padding-top: 50px;
    }
    #hiddenheader{
      padding-top: 20px;
      width: 100%;
      height: 100px;
      z-index: 0;
      position: absolute;
      top: 0px;
      background-color: white;
    }
      #bodywrapper{
        text-align:center;

      }
      #map {
        
        height:70%;
        bottom: 20px;
        width:80%;
        margin: auto;
        z-index: 1;
        position: absolute;
        right: 0px;
      }

#sidebar {
  float: left;
  width: 19%;
  top:0px;
  height: 500px;
  z-index: 0;
  position: absolute;
  text-align: left;
  padding-right: 5px;
  color: #869DB2;
  background-color: white;
}
#weather {
  padding-top: 300px;
}
#thumbnail {
  width: 100%;
  height: 100%;
  z-index: 5;
  position: absolute;
}
#precipitation {
  padding-top: 20px;
}

    </style>
</head>
<body>



  <div id="bodywrapper">
    <div id="header">
      <h1 id="output"></h1>
    </div>
    <div id="hiddenheader"></div>
      <div id="map"></div>
      <div id="rain"></div>
      <div id="thumbnail"></div>
    <div id="sidebar">
      <div id="weather"></div>
      <div id="precipitation"></div>
    </div>
      <div id="temperature"></div>
      <div id="location"></div>
</div>

</body>
</html>
